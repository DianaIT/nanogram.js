/**
*
* nanogram.js
*
* @version 1.0.2
* @author webistomin
* @email: webistomin@gmail.com
* @license: MIT
*
**/

function t(o){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(o)}var o=function(){return(o=Object.assign||function(t){for(var o,n=1,r=arguments.length;n<r;n++)for(var e in o=arguments[n])Object.prototype.hasOwnProperty.call(o,e)&&(t[e]=o[e]);return t}).apply(this,arguments)};function n(t,o,n,r){return new(n||(n=Promise))((function(e,i){function l(t){try{u(r.next(t))}catch(t){i(t)}}function a(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){var o;t.done?e(t.value):(o=t.value,o instanceof n?o:new n((function(t){t(o)}))).then(l,a)}u((r=r.apply(t,o||[])).next())}))}function r(t,o){var n,r,e,i,l={label:0,sent:function(){if(1&e[0])throw e[1];return e[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;l;)try{if(n=1,r&&(e=2&i[0]?r.return:i[0]?r.throw||((e=r.return)&&e.call(r),0):r.next)&&!(e=e.call(r,i[1])).done)return e;switch(r=0,e&&(i=[2&i[0],e.value]),i[0]){case 0:case 1:e=i;break;case 4:return l.label++,{value:i[1],done:!1};case 5:l.label++,r=i[1],i=[0];continue;case 7:i=l.ops.pop(),l.trys.pop();continue;default:if(!(e=l.trys,(e=e.length>0&&e[e.length-1])||6!==i[0]&&2!==i[0])){l=0;continue}if(3===i[0]&&(!e||i[1]>e[0]&&i[1]<e[3])){l.label=i[1];break}if(6===i[0]&&l.label<e[1]){l.label=e[1],e=i;break}if(e&&l.label<e[2]){l.label=e[2],l.ops.push(i);break}e[2]&&l.ops.pop(),l.trys.pop();continue}i=o.call(t,l)}catch(t){i=[6,t],r=0}finally{n=e=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}}var e=function(){function e(){this.INSTAGRAM_HOSTNAME="https://www.instagram.com/",this.SHARED_DATA_TAG_EXP=/^[\w\W]*<script type="text\/javascript">window._sharedData = ({[\w\W]*});<\/script>[\w\W]*$/g}return e.prototype.buildUrl=function(t){return""+this.INSTAGRAM_HOSTNAME+t},e.prototype.parseJSON=function(t,o){try{var n=t;return o&&(n=t.replace(this.SHARED_DATA_TAG_EXP,"$1")),JSON.parse(n)}catch(t){console.error("Nanogram: failure during parsing JSON.\nError message: "+t.message)}},e.prototype.HTTP=function(o,e){return void 0===e&&(e=!0),n(this,void 0,void 0,(function(){var n;return r(this,(function(r){switch(r.label){case 0:if("object"===t(o))throw new Error("Not implemented");return[4,function(t,o){return new Promise((function(n,r){var e=new XMLHttpRequest;e.open(t,o),e.onload=function(){return n(e)},e.onerror=r,e.send()}))}("GET",o).then((function(t){if(t.status>=200&&t.status<400)return t.responseText;console.error("Nanogram: error during request.\nProbably making too many requests to the Instagram application.\nAlso check method parameters.")}))];case 1:return(n=r.sent())?[2,this.parseJSON(n,e)]:[2]}}))}))},e.logError=function(t){var o="Nanogram: please provide a valid "+t.join(" and ");console.error(o)},e.prototype.getMediaByUsername=function(t){var i,l,a;return n(this,void 0,void 0,(function(){var n,u,s,c;return r(this,(function(r){switch(r.label){case 0:return n={profile:null,ok:!1},t?(u=this.buildUrl(t),[4,this.HTTP(u)]):(e.logError(["username"]),[2,n]);case 1:return s=r.sent(),c=(null===(a=null===(l=null===(i=null==s?void 0:s.entry_data)||void 0===i?void 0:i.ProfilePage[0])||void 0===l?void 0:l.graphql)||void 0===a?void 0:a.user)||null,[2,o(o({},n),{profile:c,ok:Boolean(c)})]}}))}))},e.prototype.getMediaByTag=function(t){var i,l;return n(this,void 0,void 0,(function(){var n,a,u,s;return r(this,(function(r){switch(r.label){case 0:return n={tag:null,ok:!1},t?(a=this.buildUrl("explore/tags/"+t),[4,this.HTTP(a)]):(e.logError(["tag"]),[2,n]);case 1:return u=r.sent(),s=(null===(l=null===(i=null==u?void 0:u.entry_data)||void 0===i?void 0:i.TagPage[0])||void 0===l?void 0:l.graphql.hashtag)||null,[2,o(o({},n),{tag:s,ok:Boolean(s)})]}}))}))},e.prototype.getMediaByLocation=function(t,i){var l,a,u;return n(this,void 0,void 0,(function(){var n,s,c,d;return r(this,(function(r){switch(r.label){case 0:return n={location:null,ok:!1},void 0!==t&&i?(s=this.buildUrl("explore/locations/"+t+"/"+i),[4,this.HTTP(s)]):(e.logError(["location id","place name"]),[2,n]);case 1:return c=r.sent(),d=(null===(u=null===(a=null===(l=null==c?void 0:c.entry_data)||void 0===l?void 0:l.LocationsPage[0])||void 0===a?void 0:a.graphql)||void 0===u?void 0:u.location)||null,[2,o(o({},n),{location:d,ok:Boolean(d)})]}}))}))},e.prototype.getCountries=function(){var t,e;return n(this,void 0,void 0,(function(){var n,i,l,a;return r(this,(function(r){switch(r.label){case 0:return n={country_list:null,ok:!1},i=this.buildUrl("explore/locations/"),[4,this.HTTP(i)];case 1:return l=r.sent(),a=(null===(e=null===(t=null==l?void 0:l.entry_data)||void 0===t?void 0:t.LocationsDirectoryPage[0])||void 0===e?void 0:e.country_list)||null,[2,o(o({},n),{country_list:a,ok:Boolean(a)})]}}))}))},e.prototype.getCitiesByCountryId=function(t){var i;return n(this,void 0,void 0,(function(){var n,l,a,u,s,c,d,v;return r(this,(function(r){switch(r.label){case 0:return n={city_list:null,country_info:null,ok:!1},t?(l=this.buildUrl("explore/locations/"+t),[4,this.HTTP(l)]):(e.logError(["country id"]),[2,n]);case 1:return a=r.sent(),u=o({},null===(i=null==a?void 0:a.entry_data)||void 0===i?void 0:i.LocationsDirectoryPage[0]),s=u.city_list,c=void 0===s?null:s,d=u.country_info,v=void 0===d?null:d,[2,o(o({},n),{country_info:v,city_list:c,ok:Boolean(v||c)})]}}))}))},e.prototype.getPlacesByCityId=function(t){var i;return n(this,void 0,void 0,(function(){var n,l,a,u,s,c,d,v,f,p;return r(this,(function(r){switch(r.label){case 0:return n={place:{city_info:null,country_info:null,location_list:null},ok:!1},t?(l=this.buildUrl("explore/locations/"+t),[4,this.HTTP(l)]):(e.logError(["city id"]),[2,n]);case 1:return a=r.sent(),u=o({},null===(i=null==a?void 0:a.entry_data)||void 0===i?void 0:i.LocationsDirectoryPage[0]),s=u.city_info,c=void 0===s?null:s,d=u.country_info,v=void 0===d?null:d,f=u.location_list,p=void 0===f?null:f,[2,o(o({},n),{place:{city_info:c,country_info:v,location_list:p},ok:Boolean(c||v||p)})]}}))}))},e.prototype.getMediaByPlaceId=function(t){var i,l;return n(this,void 0,void 0,(function(){var n,a,u,s;return r(this,(function(r){switch(r.label){case 0:return n={location:null,ok:!1},t?(a=this.buildUrl("explore/locations/"+t),[4,this.HTTP(a)]):(e.logError(["place id"]),[2,n]);case 1:return u=r.sent(),s=(null===(l=null===(i=null==u?void 0:u.entry_data)||void 0===i?void 0:i.LocationsPage[0])||void 0===l?void 0:l.graphql.location)||null,[2,o(o({},n),{location:s,ok:Boolean(s)})]}}))}))},e.prototype.getMediaBySearchQuery=function(t){return n(this,void 0,void 0,(function(){var n,i,l,a,u,s,c,d,v;return r(this,(function(r){switch(r.label){case 0:return n={media:{users:null,hashtags:null,places:null},ok:!1},t?(i=this.buildUrl("web/search/topsearch/?context=blended&query="+t+"&include_reel=true"),[4,this.HTTP(i,!1)]):(e.logError(["search query"]),[2,n]);case 1:return l=r.sent(),a=l.users,u=void 0===a?null:a,s=l.hashtags,c=void 0===s?null:s,d=l.places,v=void 0===d?null:d,[2,o(o({},n),{media:{users:u,hashtags:c,places:v},ok:Boolean(u||c||v)})]}}))}))},e}();export default e;
